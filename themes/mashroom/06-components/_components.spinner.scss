@use '../02-tools/tools.trippy-effects' as trippy;
@use '../02-tools/tools.psychedelic-gradients' as gradients;
@use '../01-settings/settings.colors' as colors;
@use '../01-settings/settings.config' as config;
@use '../01-settings/settings.spinner' as spinner;
@use '../01-settings/settings.maps' as maps;
@use 'sass:map';

// Psychedelic spinner animations
@keyframes spinner {
  to {
    transform: rotate(360deg) #{'/* rtl:ignore */'};
  }
}

@keyframes psychedelic-spinner {
  0% {
    transform: rotate(0deg) scale(1);
    filter: hue-rotate(0deg);
  }
  25% {
    transform: rotate(90deg) scale(1.1);
    filter: hue-rotate(90deg);
  }
  50% {
    transform: rotate(180deg) scale(1);
    filter: hue-rotate(180deg);
  }
  75% {
    transform: rotate(270deg) scale(0.9);
    filter: hue-rotate(270deg);
  }
  100% {
    transform: rotate(360deg) scale(1);
    filter: hue-rotate(360deg);
  }
}

@keyframes spinner-glow {
  0%,
  100% {
    box-shadow: 0 0 10px colors.$primary-6;
  }
  25% {
    box-shadow:
      0 0 20px colors.$blue-6,
      0 0 30px colors.$blue-6;
  }
  50% {
    box-shadow: 0 0 10px colors.$green-6;
  }
  75% {
    box-shadow:
      0 0 20px colors.$red-6,
      0 0 30px colors.$red-6;
  }
}

@keyframes spinner-float {
  0%,
  100% {
    transform: translateY(0px);
  }
  50% {
    transform: translateY(-5px);
  }
}

@keyframes rainbow-spinner {
  0% {
    background-position: 0% 50%;
  }
  100% {
    background-position: 100% 50%;
  }
}

.c-spinner {
  --#{config.$prefix}spinner-size: #{map.get(spinner.$spinner-sizes, md)};
  --#{config.$prefix}spinner-background-color: #{spinner.$spinner-background-color};
  --#{config.$prefix}spinner-color: #{spinner.$spinner-color};
  --#{config.$prefix}spinner-border-width: #{spinner.$spinner-border-width};
  --#{config.$prefix}spinner-animation-speed: #{spinner.$spinner-animation-speed};

  color: var(--#{config.$prefix}spinner-background-color);
  position: relative;

  // Use a psychedelic gradient for the spinner
  background: conic-gradient(
    colors.$primary-6,
    colors.$blue-6,
    colors.$green-6,
    colors.$yellow-6,
    colors.$red-6,
    colors.$primary-6
  );
  border-radius: 50%;
  animation:
    psychedelic-spinner var(--#{config.$prefix}spinner-animation-speed) ease-in-out infinite,
    spinner-glow var(--#{config.$prefix}spinner-animation-speed) ease infinite;

  // Add a glow effect
  @include trippy.trippy-glow(colors.$primary-6, 10px);

  // Add floating animation
  @include trippy.float-animation();
  animation-duration: 4s;

  // Add a central "hole" to make it look like a ring
  &::before {
    content: '';
    position: absolute;
    top: 10%;
    left: 10%;
    right: 10%;
    bottom: 10%;
    background-color: colors.$black;
    border-radius: 50%;
  }

  // Size variants
  @each $size, $value in spinner.$spinner-sizes {
    &--#{$size} {
      --#{config.$prefix}spinner-size: #{$value};
    }
  }

  // Color variants
  @each $color, $value in maps.$theme-colors {
    &--#{$color} {
      @if ($color == 'secondary') {
        --#{config.$prefix}spinner-background-color: var(--#{config.$prefix}body-bg);
      }

      --#{config.$prefix}spinner-color: var(--#{config.$prefix}#{$color});

      // Apply color-specific effects
      @if ($color == 'primary') {
        animation:
          psychedelic-spinner var(--#{config.$prefix}spinner-animation-speed) ease-in-out infinite,
          spinner-glow var(--#{config.$prefix}spinner-animation-speed) ease infinite;
      } @else {
        // For other colors, use a simpler animation
        animation: spinner var(--#{config.$prefix}spinner-animation-speed) linear infinite;
      }
    }
  }

  // Growing variant
  &--growing {
    animation:
      spinner var(--#{config.$prefix}spinner-animation-speed) linear infinite,
      spinner-grow 1s linear infinite;

    @keyframes spinner-grow {
      0%,
      100% {
        transform: scale(1);
      }
      50% {
        transform: scale(1.2);
      }
    }
  }

  // Psychedelic variant
  &--psychedelic {
    @include gradients.rainbow-gradient();
    background-size: 300% 300%;
    animation:
      rainbow-spinner 2s linear infinite,
      spinner-glow 1s ease infinite,
      spinner-float 3s ease-in-out infinite;
    border-radius: 50%;

    &::before {
      background-color: rgba(colors.$black, 0.7);
    }
  }

  // Glowing variant
  &--glow {
    @include trippy.trippy-glow(colors.$purple-4, 20px);
    animation:
      spinner-glow 0.5s ease infinite,
      spinner-float 2s ease-in-out infinite;

    &::before {
      background-color: rgba(colors.$black, 0.5);
    }
  }

  // Floating variant
  &--floating {
    @include trippy.float-animation();
    animation-duration: 2s;
  }
}
